<html>
<head>
<title>rMate Flash Grid</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<script type="text/javaScript" src="./JS/AC_OETags.js"></script>
<script type="text/javaScript" src="./JS/rMateGrid.js"></script>
<script type="text/javaScript" src="./JS/rMateGridLicense.js"></script>
<style>
body { margin: 0px; font-family: "굴림", "굴림체"; }
</style>

<!-- 사용자 정의 설정 시작 -->
<script type="text/javascript">

// ----------------------- rMateGrid flashVars 설정 시작 -----------------------

// rMateGrid 레이아웃 URL 경로. 반드시 설정하십시오.
var layoutURL = encodeURIComponent("./LayoutXml/LayoutSimple.xml");
var flashVars = "layoutURL="+layoutURL;

// 데이타가 JSON형일 경우 넣어줍니다. (설정을 안할경우 xml로 인식하여 오류가 발생합니다)
flashVars += "&dataType=json";

// ----------------------- rMateGrid flashVars 설정 끝 -----------------------

// rMateGrid 관련 객체
var gridApp;	// 플래시 기본 객체
var gridRoot;	// 데이타와 그리드를 포함하는 객체

// rMateGrid가 로딩된 후 불려지는 함수
var rMateGridOnLoad = function() {
	gridApp = FABridge.gridBridge.root();
	gridRoot = gridApp.getGridRoot();

	var layoutCompleteHandler = function(event) {
		gridApp.setData(gridData);
	}

	gridRoot.addEventListener("layoutComplete", layoutCompleteHandler);
}

// rMateGrid가 로딩된 후 불려질 함수를 설정합니다.
FABridge.addInitializationCallback("gridBridge", rMateGridOnLoad);

var gridData = [
		{From: "Amit1", Subject: "GMC-1 Release1", ReceiveDate: "12/09/06", SendDate: "12/09/06", CC: "Jim", Length: 75126, Level: 1, AttachCount: 0},
		{From: "Amit1", Subject: "GMC-1 Release3", ReceiveDate: "12/08/06", SendDate: "12/08/05", CC: "Jim", Length: 1654, Level: 3, AttachCount: 1},
		{From: "Barb1", Subject: "GMC-1 Release3", ReceiveDate: "12/07/06", SendDate: "12/07/06", CC: "Anant", Length: 651616, Level: 1, AttachCount: 3},
		{From: "Barb1", Subject: "GMC-1 Release4", ReceiveDate: "12/08/06", SendDate: "12/08/05", CC: "Anant", Length: 8453, Level: 1, AttachCount: 6},
		{From: "Harry1", Subject: "GMC-1 Release2", ReceiveDate: "11/02/06", SendDate: "11/02/06", CC: "Ram", Length: 1230351, Level: 2, AttachCount: 2},
		{From: "Harry1", Subject: "GMC-1 Release3", ReceiveDate: "11/02/06", SendDate: "11/02/06", CC: "Ram", Length: 89415, Level: 8, AttachCount: 0},
		{From: "John1", Subject: "GMC-1 Release2", ReceiveDate: "12/07/06", SendDate: "12/07/06", CC: "Jim", Length: 312547, Level: 7, AttachCount: 0},
		{From: "John1", Subject: "GMC-1 Release3", ReceiveDate: "12/07/06", SendDate: "12/07/06", CC: "Jim", Length: 4656, Level: 2, AttachCount: 1},
		{From: "Phill1", Subject: "GMC-1 Release3", ReceiveDate: "12/08/06", SendDate: "12/07/05", CC: "Jim", Length: 35748, Level: 9, AttachCount: 12},
		{From: "Phill1", Subject: "GMC-1 Release4", ReceiveDate: "12/08/06", SendDate: "12/07/22", CC: "Jim", Length: 70416, Level: 1, AttachCount: 31},
		{From: "리아모어1", Subject: "GMC-1 Release4", ReceiveDate: "11/21/06", SendDate: "11/21/06", CC: "현대", Length: 6813, Level: 1, AttachCount: 2},
];

var gridData2 = [
		{From: "Amit2", Subject: "GMC-1 Release1", ReceiveDate: "12/09/06", SendDate: "12/09/06", CC: "Jim", Length: 451572, Level: 1, AttachCount: 0},
		{From: "Amit2", Subject: "GMC-1 Release3", ReceiveDate: "12/08/06", SendDate: "12/08/05", CC: "Jim", Length: 693572, Level: 3, AttachCount: 1},
		{From: "Amit2", Subject: "GMC-1 Release3", ReceiveDate: "12/08/06", SendDate: "12/08/06", CC: "Jim", Length: 8281, Level: 1, AttachCount: 12},
		{From: "Barb2", Subject: "GMC-1 Release3", ReceiveDate: "12/07/06", SendDate: "12/07/06", CC: "Anant", Length: 82371, Level: 2, AttachCount: 3},
		{From: "Barb2", Subject: "GMC-1 Release4", ReceiveDate: "12/08/06", SendDate: "12/08/05", CC: "Anant", Length: 9286, Level: 5, AttachCount: 6},
		{From: "Harry2", Subject: "GMC-1 Release2", ReceiveDate: "11/02/06", SendDate: "11/02/06", CC: "Ram", Length: 2468, Level: 6, AttachCount: 2},
		{From: "Harry2", Subject: "GMC-1 Release3", ReceiveDate: "11/02/06", SendDate: "11/02/06", CC: "Ram", Length: 863145, Level: 1, AttachCount: 0},
		{From: "John2", Subject: "GMC-1 Release2", ReceiveDate: "12/07/06", SendDate: "12/07/06", CC: "Jim", Length: 6514, Level: 4, AttachCount: 0},
		{From: "John2", Subject: "GMC-1 Release3", ReceiveDate: "12/07/06", SendDate: "12/07/06", CC: "Jim", Length: 325418, Level: 2, AttachCount: 1},
		{From: "Phill2", Subject: "GMC-1 Release1", ReceiveDate: "12/08/06", SendDate: "12/07/05", CC: "Jim", Length: 2464, Level: 8, AttachCount: 12},
		{From: "Phill2", Subject: "GMC-1 Release1", ReceiveDate: "12/08/06", SendDate: "12/07/22", CC: "Jim", Length: 9841, Level: 9, AttachCount: 31},
		{From: "Phill2", Subject: "GMC-1 Release3", ReceiveDate: "12/08/06", SendDate: "12/07/27", CC: "Jim", Length: 1575, Level: 1, AttachCount: 0},
		{From: "Phill2", Subject: "GMC-1 Release4", ReceiveDate: "12/08/06", SendDate: "12/07/06", CC: "Jim", Length: 91559, Level: 3, AttachCount: 1},
		{From: "리아모어2", Subject: "GMC-1 Release4", ReceiveDate: "11/21/06", SendDate: "11/21/06", CC: "현대", Length: 4510, Level: 3, AttachCount: 2},
		{From: "리아모어2", Subject: "GMC-1 Release5", ReceiveDate: "11/19/06", SendDate: "11/19/06", CC: "삼성", Length: 10569, Level: 2, AttachCount: 1},
		{From: "리아모어2", Subject: "GMC-1 Release6", ReceiveDate: "11/22/06", SendDate: "11/22/06", CC: "삼성", Length: 56956, Level: 1, AttachCount: 0}
];

function changeDataURL() {
	gridApp.setDataURLEx("./DataXml/DataOneDepthMailSend.txt");
}

function changeData() {
	gridApp.setData(gridData2);
}
</script>
<!-- 사용자 정의 설정 끝  -->
</head>

<body onLoad="rMateGridInit()">
<table align="center" border="0" cellpadding="0" cellspacing="0" width="100%" height="100%">
	<tr height="80">
		<td width="7%"></td>
		<td align="center" valign="middle">
			<br>
			<b>JavaScript로 동적으로 데이타 변경</b>
		</td>
		<td width="7%"></td>
	</tr>
	<tr height="50">
		<td></td>
		<td align="right">
			<input type="button" value="데이타URL 변경" onClick="changeDataURL()"/>
			<input type="button" value="setData로 변경" onClick="changeData()"/>
		</td>
		<td></td>
	</tr>
	<tr>
		<td></td>
		<td align="center">
			<table border="0" cellpadding="0" cellspacing="0" width="100%" height="100%">
				<tr>
					<td>
						<script type="text/javascript">
						<!--
							rMateGridCreate("grid1", "../Component/rMateGridWeb", flashVars, "100%", "100%", "#FFFFFF");
						// -->
						</script>
					</td>
				</tr>
			</table>
		</td>
		<td></td>
	</tr>
	<tr height="100">
		<td></td>
		<td align="center" valign="middle">
			<a href="#" onClick="javascript:window.open(decodeURIComponent('./LayoutXml/LayoutSimple.xml'), '_blank', 'width=1024 height=768 scrollbars=yes')">
			<img src="./Images/viewLayout.png" width="100" height="22" border="0"/></a>
		</td>
		<td></td>
	</tr>
</table>

</body>
</html>
