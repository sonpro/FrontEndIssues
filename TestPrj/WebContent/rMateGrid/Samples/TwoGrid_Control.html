<html>
<head>
<title>rMate Flash Grid</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<script type="text/javaScript" src="./JS/AC_OETags.js"></script>
<script type="text/javaScript" src="./JS/rMateGrid.js"></script>
<script type="text/javaScript" src="./JS/rMateGridLicense.js"></script>
<style>
body { margin: 0px; font-family: "굴림", "굴림체"; }
</style>

<!-- 사용자 정의 설정 시작 -->
<script type="text/javascript">

// ----------------------- rMateGrid flashVars 설정 시작 -----------------------

// rMateGrid 레이아웃 URL 경로. 반드시 설정하십시오.
var layoutURL = encodeURIComponent("./LayoutXml/LayoutSimple.xml");
var flashVars = "layoutURL="+layoutURL;

// 데이타를 URL 경로를 통해 가져올 경우 설정하십시오.
// 배열형태로 데이터를 삽입할 경우 주석처리나 삭제하십시오.
// 배열형태와 같이 사용할 경우, 우선순위는 배열형태 데이터 삽입입니다.
var dataURL = encodeURIComponent("./DataXml/DataOneDepthMailSend.txt");
flashVars += "&dataURL="+dataURL;

// 데이타가 JSON형일 경우 넣어줍니다. (설정을 안할경우 xml로 인식하여 오류가 발생합니다)
flashVars += "&dataType=json";

// rMateGrid의 bridge 명을 다르게 주어 자바스크립트에서 제어할 수 있도록 합니다.
flashVars += "&bridgeName=gridBridge";

////////////////////////////////////////////////////////////////////////////////
// 두번째 rMateGrid 설정

// rMateGrid 레이아웃 URL 경로. 반드시 설정하십시오.
var layoutURL2 = encodeURIComponent("./LayoutXml/LayoutSimple.xml");
var flashVars2 = "layoutURL="+layoutURL2;

// 데이타를 URL 경로를 통해 가져올 경우 설정하십시오.
// 배열형태로 데이터를 삽입할 경우 주석처리나 삭제하십시오.
// 배열형태와 같이 사용할 경우, 우선순위는 배열형태 데이터 삽입입니다.
var dataURL2 = encodeURIComponent("./DataXml/DataOneDepthMailSend.txt");
flashVars2 += "&dataURL="+dataURL2;

// 데이타가 JSON형일 경우 넣어줍니다. (설정을 안할경우 xml로 인식하여 오류가 발생합니다)
flashVars2 += "&dataType=json";

// 두번째 rMateGrid의 bridge 명을 다르게 주어 자바스크립트에서 제어할 수 있도록 합니다.
flashVars2 += "&bridgeName=gridBridge2";

// ----------------------- rMateGrid flashVars 설정 끝 -----------------------

// rMateGrid 관련 객체
var gridApp;	// 플래시 기본 객체
var gridRoot;	// 데이타와 그리드를 포함하는 객체
var dataGrid;	// 그리드

// rMateGrid가 로딩된 후 불려지는 함수
var rMateGridOnLoad = function() {
	gridApp = FABridge.gridBridge.root();
	gridRoot = gridApp.getGridRoot();

	var layoutCompleteHandler = function(event) {
		dataGrid = gridApp.getDataGrid();
	}

	gridRoot.addEventListener("layoutComplete", layoutCompleteHandler);
}

// rMateGrid가 로딩된 후 불려질 함수를 설정합니다.
FABridge.addInitializationCallback("gridBridge", rMateGridOnLoad);


// 두번째 rMateGrid 관련 객체
var gridApp2;
var gridRoot2;
var dataGrid2;

// 두번째 rMateGrid가 로딩된 후 불려지는 함수
var rMateGridOnLoad2 = function() {
	gridApp2 = FABridge.gridBridge2.root();
	gridRoot2 = gridApp2.getGridRoot();

	var layoutCompleteHandler2 = function(event) {
		dataGrid2 = gridApp2.getDataGrid();
	}

	gridRoot2.addEventListener("layoutComplete", layoutCompleteHandler2);
}

// 두번째 rMateGrid가 로딩된 후 불려질 함수를 설정합니다.
FABridge.addInitializationCallback("gridBridge2", rMateGridOnLoad2);


function moveRight() {
	var sIndexArr = dataGrid.getSelectedIndices();
	if (sIndexArr == null || sIndexArr.length == 0)
		return;

	// 선택한 행을 오른쪽 rMateGrid에 삽입한다.
	var sItemArr = dataGrid.getSelectedItems();
	for (var i = 0; i < sItemArr.length; i++) {
		gridRoot2.addItemAt(sItemArr[i]);
	}
	// 선택한 행 삭제. 삭제는 뒤에서 부터 한다. 따라서 가장 큰 index번호를 찾아 지워 가기 위해 sorting한다.
	sIndexArr.sort(function(a,b){return a-b});
	for (var i = sIndexArr.length - 1; i >= 0; i--) {
		gridRoot.removeItemAt(sIndexArr[i]);
	}
}

function moveLeft() {
	var sIndexArr = dataGrid2.getSelectedIndices();
	if (sIndexArr == null || sIndexArr.length == 0)
		return;

	// 선택한 행을 오른쪽 rMateGrid에 삽입한다.
	var sItemArr = dataGrid2.getSelectedItems();
	for (var i = 0; i < sItemArr.length; i++) {
		gridRoot.addItemAt(sItemArr[i]);
	}
	// 선택한 행 삭제. 삭제는 뒤에서 부터 한다. 따라서 가장 큰 index번호를 찾아 지워 가기 위해 sorting한다.
	sIndexArr.sort(function(a,b){return a-b});
	for (var i = sIndexArr.length - 1; i >= 0; i--) {
		gridRoot2.removeItemAt(sIndexArr[i]);
	}
}

</script>
<!-- 사용자 정의 설정 끝  -->
</head>

<body onLoad="rMateGridInit()">
<table align="center" border="0" cellpadding="0" cellspacing="0" width="100%" height="100%">
	<tr height="80">
		<td width="7%"></td>
		<td align="center" valign="middle">
			<br>
			<b>두개의 그리드 연동</b>
		</td>
		<td width="7%"></td>
	</tr>
	<tr height="80">
		<td></td>
		<td align="center">
			<table border="0" cellpadding="0" cellspacing="0" width="100%">
				<tr>
					<td align="center">한개의 화면에 두개의 그리드를 생성합니다.<br>행을 선택한 후 >> 또는 << 를 클릭하시면 반대편 그리드로 이동합니다.</td>
				</tr>
				<tr><td height="10"></td></tr>
				<tr>
					<td align="right">
					</td>
				</tr>
			</table>
		</td>
		<td></td>
	</tr>
	<tr>
		<td></td>
		<td align="center">
			<table border="0" cellpadding="0" cellspacing="0" width="100%" height="100%">
				<tr>
					<td width="47%" align="center">
						<script type="text/javascript">
						<!--
							rMateGridCreate("grid1", "../Component/rMateGridWeb", flashVars, "100%", "100%", "#FFFFFF");
						// -->
						</script>
					</td>
					<td width="6%" valign="middle">
						<table width="100%">
							<tr>
								<td align="center">
									<a href="javascript:moveRight()" style="text-decoration:none">>></a><br><br>
									<a href="javascript:moveLeft()" style="text-decoration:none"><<</a>
								</td>
							</tr>
						</table>
					</td>
					<td width="47%" align="center">
						<script type="text/javascript">
						<!--
							rMateGridCreate("grid2", "../Component/rMateGridWeb", flashVars2, "100%", "100%", "#FFFFFF");
						// -->
						</script>
					</td>
				</tr>
			</table>
		</td>
		<td></td>
	</tr>
	<tr height="100">
		<td></td>
		<td align="center" valign="middle">
			<a href="#" onClick="javascript:window.open(decodeURIComponent(layoutURL), '_blank', 'width=1024 height=768 scrollbars=yes')">
			<img src="./Images/viewLayout.png" width="100" height="22" border="0"/></a>
			&nbsp;&nbsp;&nbsp;&nbsp;
			<a href="#" onClick="javascript:window.open(decodeURIComponent(dataURL), '_blank', 'width=1024 height=768 scrollbars=yes')">
			<img src="./Images/viewData.png" width="100" height="22" border="0"/></a>
		</td>
		<td></td>
	</tr>
</table>

</body>
</html>
