<html>
<head>
<title>rMate Flash Grid</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<script type="text/javaScript" src="./JS/AC_OETags.js"></script>
<script type="text/javaScript" src="./JS/rMateGrid.js"></script>
<script type="text/javaScript" src="./JS/rMateGridLicense.js"></script>
<style>
body { margin: 0px; font-family: "굴림", "굴림체"; }
</style>

<!-- 사용자 정의 설정 시작 -->
<script type="text/javascript">

// ----------------------- rMateGrid flashVars 설정 시작 -----------------------

// rMateGrid 레이아웃 URL 경로. 반드시 설정하십시오.
var layoutURL = encodeURIComponent("./LayoutXml/LayoutColumnLabelJsFunction.xml");
var flashVars = "layoutURL="+layoutURL;

// 데이타를 URL 경로를 통해 가져올 경우 설정하십시오.
// 배열형태로 데이터를 삽입할 경우 주석처리나 삭제하십시오.
// 배열형태와 같이 사용할 경우, 우선순위는 배열형태 데이터 삽입입니다.
var dataURL = encodeURIComponent("./DataXml/DataOneDepthRevenues.xml");
flashVars += "&dataURL="+dataURL;

// 데이타가 JSON형일 경우 넣어줍니다. (설정을 안할경우 xml로 인식하여 오류가 발생합니다)
//flashVars += "&dataType=json";

// ----------------------- rMateGrid flashVars 설정 끝 -----------------------

// xml 파싱 객체
var xmlDoc, xmlParser;
if (window.ActiveXObject) {
	xmlDoc = new ActiveXObject("Microsoft.XMLDOM");
	xmlDoc.async = false;
} else {
	xmlParser = new DOMParser();
}

// xml loading, 파싱
function loadXmlDoc(xmlStr) {
	if (window.ActiveXObject)
		xmlDoc.loadXML(xmlStr);
	else
		xmlDoc = xmlParser.parseFromString(xmlStr, "text/xml");
}

// xml 파싱 결과에서 특정 노드의 값 가져오기
function getNodeText(nodeName) {
	var node = xmlDoc.getElementsByTagName(nodeName)[0];
	if (node != null)
		return node.text ? node.text : node.textContent;
	return null;
}

// labelJsFunction 기능을 이용하여 Quarter 컬럼에 월 분기 표시를 함께 넣어줍니다.
// labelJsFunction 함수의 파라메터는 다음과 같습니다.
// function labelJsFunction(item:Object, value:Object, column:Column)
// 		item : 해당 행의 data 객체
// 		value : 해당 셀의 라벨
// 		column : 해당 셀의 열을 정의한 Column 객체
//
function convertQuarter(item, value, column) {
	loadXmlDoc(item);
	var month = getNodeText("Month");
	var quarter = getNodeText("Quarter");
	var result = "";
	if (month != null)
		result += month + "월";
	if (quarter != null)
		if (result.length > 0)
			result += " (" + quarter + ")";
		else
			result = quarter;

	return result;
}

</script>
<!-- 사용자 정의 설정 끝  -->
</head>

<body onLoad="rMateGridInit()">
<table align="center" border="0" cellpadding="0" cellspacing="0" width="100%" height="100%">
	<tr height="80">
		<td width="7%"></td>
		<td align="center" valign="middle">
			<br>
			<b>labelJsFunction 기능을 이용한 셀의 내용 조정</b>
		</td>
		<td width="7%"></td>
	</tr>
	<tr height="50">
		<td></td>
		<td align="center">원하는 컬럼의 셀에 자바스크립트 함수를 이용하여 라벨을 변경합니다.
		</td>
		<td></td>
	</tr>
	<tr>
		<td></td>
		<td align="center">
			<table border="0" cellpadding="0" cellspacing="0" width="100%" height="100%">
				<tr>
					<td>
						<script type="text/javascript">
						<!--
							rMateGridCreate("grid1", "../Component/rMateGridWeb", flashVars, "100%", "100%", "#FFFFFF");
						// -->
						</script>
					</td>
				</tr>
			</table>
		</td>
		<td></td>
	</tr>
	<tr height="100">
		<td></td>
		<td align="center" valign="middle">
			<a href="#" onClick="javascript:window.open(decodeURIComponent(layoutURL), '_blank', 'width=1024 height=768 scrollbars=yes')">
			<img src="./Images/viewLayout.png" width="100" height="22" border="0"/></a>
			&nbsp;&nbsp;&nbsp;&nbsp;
			<a href="#" onClick="javascript:window.open(decodeURIComponent(dataURL), '_blank', 'width=1024 height=768 scrollbars=yes')">
			<img src="./Images/viewData.png" width="100" height="22" border="0"/></a>
		</td>
		<td></td>
	</tr>
</table>

</body>
</html>
