<html>
<head>
<title>rMate Flash Grid</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<script type="text/javaScript" src="./JS/AC_OETags.js"></script>
<script type="text/javaScript" src="./JS/rMateGrid.js"></script>
<script type="text/javaScript" src="./JS/rMateGridLicense.js"></script>
<style>
body { margin: 0px; font-family: "굴림", "굴림체"; }
</style>

<!-- 사용자 정의 설정 시작 -->
<script type="text/javascript">

// ----------------------- rMateGrid flashVars 설정 시작 -----------------------

// rMateGrid 레이아웃 URL 경로. 반드시 설정하십시오.
var layoutURL = encodeURIComponent("./LayoutXml/LayoutEditingJavaScript.xml");
var flashVars = "layoutURL="+layoutURL;

// 데이타를 URL 경로를 통해 가져올 경우 설정하십시오.
// 배열형태로 데이터를 삽입할 경우 주석처리나 삭제하십시오.
// 배열형태와 같이 사용할 경우, 우선순위는 배열형태 데이터 삽입입니다.
var dataURL = encodeURIComponent("./DataXml/DataOneDepthSales.txt");
flashVars += "&dataURL="+dataURL;

// 데이타가 JSON형일 경우 넣어줍니다. (설정을 안할경우 xml로 인식하여 오류가 발생합니다)
flashVars += "&dataType=json";

// ----------------------- rMateGrid flashVars 설정 끝 -----------------------

// rMateGrid 관련 객체
var gridApp;	// 플래시 기본 객체
var gridRoot;	// 데이타와 그리드를 포함하는 객체

// rMateGrid가 로딩된 후 불려지는 함수
var rMateGridOnLoad = function() {
	gridApp = FABridge.gridBridge.root();
	gridRoot = gridApp.getGridRoot();
	
	// 마우스 휠 이벤트 리스너를 적용합니다.
	addGridMouseWheelEventListener();
}

// rMateGrid가 로딩된 후 불려질 함수를 설정합니다.
FABridge.addInitializationCallback("gridBridge", rMateGridOnLoad);

function addGridMouseWheelEventListener() {
	var ta = document.getElementById("gridDiv");
	if (window.addEventListener) {
		// Internet Explorer, Opera, Google Chrome and Safari
		ta.addEventListener('mousewheel', mouseWheelHandler, false);
		// Firefox
		ta.addEventListener('DOMMouseScroll', mouseWheelHandler, false);
	} else	// IE before version 9
		ta.onmousewheel = mouseWheelHandler;
}

function mouseWheelHandler(event) {
	if (!event)
		event = window.event;

	var ua = navigator.userAgent.toLowerCase();
	var edelta = event.wheelDelta / 40;
	if (/mozilla/.test(ua) && !/(compatible|webkit|trident)/.test(ua))
		edelta = -event.detail;
	else if (/chrome/.test(ua))
		edelta = event.wheelDelta / 80;
	var o = {
		x : event.screenX,
		y : event.screenY,
		delta : edelta,
		ctrlKey : event.ctrlKey,
		altKey : event.altKey,
		shiftKey : event.shiftKey
	};
	// 그리드가 스크롤에 반응한 경우 true 아니면 false (즉 데이타가 없거나 적거나 맨위나 맨아래등 스크롤이 필요없는 경우 false)
	var ret = gridApp.mouseWheelHandler(o);
	if (ret) {
		if (event.stopPropagation) {
			event.stopPropagation();
			event.preventDefault();
		} else {	// for IE
			event.cancelBubble = true;
			event.returnValue = false;
		}
	}
}

</script>
<!-- 사용자 정의 설정 끝  -->
</head>

<body onLoad="rMateGridInit()">
<table align="center" border="0" cellpadding="0" cellspacing="0" width="100%" height="100%">
	<tr height="80">
		<td width="7%"></td>
		<td align="center" valign="middle">
			<br>
			<b>html에서 MouseWheel이벤트 전달</b>
		</td>
		<td width="7%"></td>
	</tr>
	<tr height="80">
		<td></td>
		<td align="center">
			<table border="0" cellpadding="0" cellspacing="0" width="100%">
				<tr>
					<td align="center">wmode를 "transparent" 또는 "opaque"로 설정시 일부 브라우져에서 MouseWheel 이벤트가 발생하지 않는<br> 문제가 있어 html에서 이벤트를 받아 그리드에 넣어주도록 합니다.(html 소스 확인)</td>
				</tr>
				<tr><td height="10"></td></tr>
				<tr>
					<td align="right">
					</td>
				</tr>
			</table>
		</td>
		<td></td>
	</tr>
	<tr>
		<td></td>
		<td align="center">
			<table border="0" cellpadding="0" cellspacing="0" width="100%" height="100%">
				<tr>
					<td align="center"><div id="gridDiv" style="width:100%;height:100%">
						<script type="text/javascript">
						<!--
							rMateGridCreate("grid1", "../Component/rMateGridWeb", flashVars, "100%", "100%", "#FFFFFF", "opaque");
						// -->
						</script>
					</div></td>
				</tr>
			</table>
		</td>
		<td></td>
	</tr>
	<tr height="100">
		<td></td>
		<td align="center" valign="middle">
			<a href="#" onClick="javascript:window.open(decodeURIComponent(layoutURL), '_blank', 'width=1024 height=768 scrollbars=yes')">
			<img src="./Images/viewLayout.png" width="100" height="22" border="0"/></a>
			&nbsp;&nbsp;&nbsp;&nbsp;
			<a href="#" onClick="javascript:window.open(decodeURIComponent(dataURL), '_blank', 'width=1024 height=768 scrollbars=yes')">
			<img src="./Images/viewData.png" width="100" height="22" border="0"/></a>
		</td>
		<td></td>
	</tr>
</table>

</body>
</html>
