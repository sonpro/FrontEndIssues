<html>
<head>
<title>rMate Flash Grid</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<script type="text/javaScript" src="./JS/AC_OETags.js"></script>
<script type="text/javaScript" src="./JS/rMateGrid.js"></script>
<script type="text/javaScript" src="./JS/rMateGridLicense.js"></script>
<style>
body { margin: 0px; font-family: "굴림", "굴림체"; }
</style>

<!-- 사용자 정의 설정 시작 -->
<script type="text/javascript">

// ----------------------- rMateGrid flashVars 설정 시작 -----------------------

// rMateGrid 레이아웃 URL 경로. 반드시 설정하십시오.
var layoutURL = encodeURIComponent("./LayoutXml/LayoutSimple.xml");
var flashVars = "layoutURL="+layoutURL;

// 데이타를 URL 경로를 통해 가져올 경우 설정하십시오.
// 배열형태로 데이터를 삽입할 경우 주석처리나 삭제하십시오.
// 배열형태와 같이 사용할 경우, 우선순위는 배열형태 데이터 삽입입니다.
//var dataURL = encodeURIComponent("./DataXml/DataOneDepthMailSend.txt");
//flashVars += "&dataURL="+dataURL;

// 데이타가 JSON형일 경우 넣어줍니다. (설정을 안할경우 xml로 인식하여 오류가 발생합니다)
flashVars += "&dataType=json";

// ----------------------- rMateGrid flashVars 설정 끝 -----------------------

// rMateGrid 관련 객체
var gridApp;	// 플래시 기본 객체
var gridRoot;	// 데이타와 그리드를 포함하는 객체
var dataGrid;	// 그리드
var collection;	// 그리드의 데이타 객체

// rMateGrid가 로딩된 후 불려지는 함수
var rMateGridOnLoad = function() {
	gridApp = FABridge.gridBridge.root();
	gridRoot = gridApp.getGridRoot();

	var layoutCompleteHandler = function(event) {
		dataGrid = gridApp.getDataGrid();
		gridMovePage(gridCurrentPage);
	}

	gridRoot.addEventListener("layoutComplete", layoutCompleteHandler);}

// rMateGrid가 로딩된 후 불려질 함수를 설정합니다.
FABridge.addInitializationCallback("gridBridge", rMateGridOnLoad);

</script>
<!-- 사용자 정의 설정 끝  -->

<!-- 페이징 관련 스타일 -->
<style type="text/css">
.gridPaging { text-align:center; font-family:verdana; font-size:12px; }
.gridPaging a:link { color:#666666; text-decoration:none; }
.gridPaging a:visited { color:#666666; text-decoration:none; }
.gridPaging a:hover { text-decoration:none; color:#ff6c00; text-decoration:none; }
.gridPaging a:active { text-decoration:none; }
.gridPagingMove { font-weight:bold; }
.gridPagingDisable { font-weight:bold; color:#cccccc; }
.gridPagingCurrent { font-weight:bold; color:#ff6600; }
</style>
<!-- 페이징 관련 자바스크립트 -->
<script type="text/javascript">
<!--
var gridTotalRowCount = 580;	// 전체 데이타 건수 - html이 서버에서 작성될때 반드시 넣어줘야 하는 변수입니다.

var gridRowsPerPage = 20;	// 1페이지에서 보여줄 행 수
var gridViewPageCount = 10;		// 페이지 네비게이션에서 보여줄 페이지의 수
var gridCurrentPage = 1;	// 현재 페이지
var gridTotalPage = Math.ceil(gridTotalRowCount / gridRowsPerPage);	// 전체 페이지 계산

// 화면에 표시할 맨앞으로 와 맨뒤로, 앞으로, 뒤로 문구 - 이미지를 쓸 경우 img 태그로 대체
var gridStartTxt = "<<";
var gridEndTxt = ">>";
var gridPrevTxt = "◀";
var gridNextTxt = "▶";
var gridPageGapTxt = " | ";	// 페이지 사이의 구분을 위한 문자 - 사용하지 않을 경우 공백을 넣습니다.

// 주어진 페이지 번호에 따라 페이지 네비게이션 html을 만들고 gridPageNavigationDiv에 innerHTML로 넣어줍니다.
function drawGridPagingNavigation(goPage) {
	if (gridTotalPage == 0) {
		gridPageNavigationDiv.innerHTML = "<span class='gridPagingDisable'>" + gridStartTxt + "</span> <span class='gridPagingDisable'>" + gridPrevTxt + "</span> <span class='gridPagingDisable'>" + gridNextTxt + "</span> <span class='gridPagingDisable'>" + gridEndTxt + "</span>";
		return;
	}

	var retStr = "";
	var prepage = parseInt((goPage - 1)/gridViewPageCount) * gridViewPageCount;
	var nextpage = ((parseInt((goPage - 1)/gridViewPageCount)) * gridViewPageCount) + gridViewPageCount + 1;

	// 맨앞으로
	retStr += "<span class=";
	if (goPage > 1) {
		retStr += "'gridPagingMove'><a href='javascript:gridMovePage(1)'>" + gridStartTxt + "</a></span> ";
	} else {
		retStr += "'gridPagingDisable'>" + gridStartTxt + "</span> ";
	}

	// 앞으로
	retStr += "<span class=";
	if (goPage > gridViewPageCount) {
		retStr += "'gridPagingMove'><a href='javascript:gridMovePage(" + prepage + ")'>" + gridPrevTxt + "</a></span> ";
	} else {
		retStr += "'gridPagingDisable'>" + gridPrevTxt + "</span> ";
	}

	for (var i = (1 + prepage); i < gridViewPageCount + 1 + prepage; i++) {
		if (goPage == i) {
			retStr += "<span class='gridPagingCurrent'>";
			retStr += i;
			retStr += "</span>";
		} else {
			retStr += "<span>";
			retStr += "<a href='javascript:gridMovePage(" + i + ")'>" + i + "</a>";
			retStr += "</span>";
		}

		if (i >= gridTotalPage) {
			retStr += " ";
			break;
		}

		if (i == gridViewPageCount + prepage)
			retStr += " ";
		else
			retStr += gridPageGapTxt;
	}

	// 뒤로
	retStr += "<span class=";
	if (nextpage <= gridTotalPage) {
		retStr += "'gridPagingMove'><a href='javascript:gridMovePage(" + nextpage + ")'>" + gridNextTxt + "</a></span> ";
	} else {
		retStr += "'gridPagingDisable'>" + gridNextTxt + "</span> ";
	}

	// 맨뒤로
	retStr += "<span class=";
	if (goPage != gridTotalPage) {
		retStr += "'gridPagingMove'><a href='javascript:gridMovePage(" + gridTotalPage + ")'>" + gridEndTxt + "</span>";
	} else {
		retStr += "'gridPagingDisable'>" + gridEndTxt + "</span>";
	}
	gridPageNavigationDiv.innerHTML = retStr;
}

function gridMovePage(goPage) {
	// 테스트를 위해 리아모어 서버에 예를 넣어 두었습니다. 개발후 실제 url로 변경하시기 바랍니다.
	gridApp.setDataURLEx("http://www.riamore.net/bbs/gridPagingData.jsp?page="+goPage);
	drawGridPagingNavigation(goPage);
	gridCurrentPage = goPage;
}
-->
</script>
</head>

<body onLoad="rMateGridInit()">
<table align="center" border="0" cellpadding="0" cellspacing="0" width="100%" height="100%">
	<tr height="80">
		<td width="7%"></td>
		<td align="center" valign="middle">
			<br>
			<b>그리드에서 페이징 구현</b>
		</td>
		<td width="7%"></td>
	</tr>
	<tr height="50">
		<td></td>
		<td align="center">html로 페이징을 구현하고 페이지 네비게이션에 따라<br>setDataURLEx함수를 이용하여 페이징을 구현하는 예입니다
		</td>
		<td></td>
	</tr>
	<tr>
		<td></td>
		<td align="center">
			<table border="0" cellpadding="0" cellspacing="0" width="100%" height="100%">
				<tr>
					<td align="center">
						<script type="text/javascript">
						<!--
							rMateGridCreate("grid1", "../Component/rMateGridWeb", flashVars, "100%", "100%", "#FFFFFF");
						// -->
						</script>
					</td>
				</tr>
			</table>
		</td>
		<td></td>
	</tr>
	<tr height="80">
		<td></td>
		<td align="center" valign="middle">
			<div class="gridPaging" id="gridPageNavigationDiv">
		</td>
		<td></td>
	</tr>
	<tr height="100">
		<td></td>
		<td align="center" valign="middle">
			<a href="#" onClick="javascript:window.open(decodeURIComponent(layoutURL), '_blank', 'width=1024 height=768 scrollbars=yes')">
			<img src="./Images/viewLayout.png" width="100" height="22" border="0"/></a>
		</td>
		<td></td>
	</tr>
</table>

</body>
</html>
